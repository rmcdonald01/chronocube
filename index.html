<!DOCTYPE html>
<!-- COPYRIGHT PABLO VARELA 2016  -->
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Chronocube by pablopunk</title>
    <link rel="stylesheet" type="text/css" href="css/index.css"/>
    <link href="css/ionicons.min.css" rel="stylesheet">
    <!-- skeleton -->
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/skeleton.css">
    
    <!-- JS -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js"></script>
    <script type="text/javascript">
    function sleep(milliseconds)
    {
      var start = new Date().getTime();
      for (var i = 0; i < 1e7; i++) {
        if ((new Date().getTime() - start) > milliseconds){
          break;
        }
      }
    }
    
    $( document ).ready(function()
    {
      $('#screenshot').mouseover(changeScreenshotToBlack); // bind
      $('#screenshot').mouseout (changeScreenshotToWhite); 
      
      // initial state
      $('#tit').css("opacity", 0);
      $('#subtit').css("opacity", 0);
      $('#content').css({
        "opacity": 0,
        "margin-top": "-20vh"
      });
      $('.buttons').css({
        "margin-top": "100vh"
      });

      // animations
      $('#content').animate({
        opacity: 1,
        "margin-top": "+=20vh"
      }, 2000, 'easeInOutExpo');
      $("#tit").animate({
					opacity: '1',
			}, 3000, 'easeInOutCirc');
      $("#subtit").animate({
					opacity: '1',
			}, 3000, 'easeInOutCirc');
      $('.buttons').animate({
        "margin-top": "-=100vh"
      }, 2000, 'easeInOutExpo');
      
      updateLinkWithLatestRelease() // call AJAX function
    });
    
    function getDownloadLink(release, os) {
      var githubURL = 'https://github.com/pablopunk/chronocube/releases/download/' +release
      if (os === 'Mac') githubURL += '/Chronocube-Mac.dmg';
      else if (os === 'Windows') githubURL += '/Chronocube-Windows-Installer.exe';
      else return 'https://github.com/pablopunk/chronocube/releases'; // no file for other OS
      return githubURL;
    }
    
    function getOS() {
      var platform = navigator.platform;
      if (platform.match(/(Mac)/i)) return 'Mac';
      if (platform.match(/(Win)/i)) return 'Windows';
      return 'Other';
    }
    
    function updateLinkWithLatestRelease() {
      $.getJSON("https://api.github.com/repos/pablopunk/chronocube/releases/latest").done(function (release) {
        var os = getOS()
        var link = getDownloadLink(release.tag_name, os)
        $('#downloadLink').attr("href", link)
        if (os !== 'Other') $('#os').text('for '+os);
      });
    }
    
    function changeScreenshotToBlack() {
      $('#screenshot').fadeOut( 200, function() {
        $(this).attr('src', 'img/screenshot-black.png').fadeIn(200)
      })
    }
    
    function changeScreenshotToWhite() {
      $('#screenshot').fadeOut( 200, function() {
        $(this).attr('src', 'img/screenshot-white.png').fadeIn(200)
      })
    }
    </script>
  </head>

  <body>
    
    <div class="twelve columns" align="center">
      <div id="tit">Chronocube</div>
      <div id="subtit">Your rubik's cube solves.</div>
      <div id="content">
        <img id="screenshot" src="img/screenshot-white.png" alt="screenshot"/>
        <div class="buttons">
          <div class="row"><a class="button button-link" href="https://github.com/pablopunk/chronocube/releases/latest" id="downloadLink"><i class="icon ion-ios-cloud-download-outline"></i> Download <span id="os"></span></a></div>
          <div class="row"><a class="button button-link" href="http://chronocube.pablopunk.com"><i class="icon ion-social-html5-outline"></i> Use it online</a></div>
          <div class="row"><a class="button button-link" href="https://github.com/pablopunk/chronocube"><i class="icon ion-code"></i> Source code</a></div>
        </div>
      </div>
    </div>
    
  </body>
</html>
