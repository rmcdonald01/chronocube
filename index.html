<!DOCTYPE html>
<!-- COPYRIGHT PABLO VARELA 2016  -->
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Chronocube by pablopunk</title>
    <link rel="stylesheet" type="text/css" href="css/index.css"/>
    <link href="css/ionicons.min.css" rel="stylesheet">
    <script type="text/javascript" src="http://code.jquery.com/jquery-1.11.3.min.js"></script>
    <script type="text/javascript">
    function sleep(milliseconds)
    {
      var start = new Date().getTime();
      for (var i = 0; i < 1e7; i++) {
        if ((new Date().getTime() - start) > milliseconds){
          break;
        }
      }
    }
    
    $( document ).ready(function()
    {
      $('#screenshot').mouseover(changeScreenshotToBlack); // bind
      $('#screenshot').mouseout (changeScreenshotToWhite); 
      
      // initial state
      $('#tit').css("opacity", 0);
      $('#subtit').css("opacity", 0);
      $('#content').css({
        "opacity": 0,
        "margin-top": "-20vh"
      });

      // animations
      $('#content').animate({
        opacity: 1,
        "margin-top": "+=20vh"
      },{duration: 1000, queue: false}, 'easeInOutCirc');
      $("#tit").animate({
					opacity: '1',
			}, {duration: 3000, queue: false}, 'easeInOutCirc');
      $("#subtit").animate({
					opacity: '1',
			}, {duration: 3000, queue: false}, 'easeInOutCirc');
      
      updateLinkWithLatestRelease() // call AJAX function
    });
    
    function getDownloadLink(release, os) {
      var githubURL = 'https://github.com/pablopunk/chronocube/releases/download/' +release
      if (os === 'Mac') githubURL += '/Chronocube-Mac.dmg';
      else if (os === 'Windows') githubURL += '/Chronocube-Windows-Installer.exe';
      else return 'https://github.com/pablopunk/chronocube/releases'; // no file for other OS
      return githubURL;
    }
    
    function getOS() {
      var platform = navigator.platform;
      if (platform.match(/(Mac)/i)) return 'Mac';
      if (platform.match(/(Win)/i)) return 'Windows';
      return 'Other';
    }
    
    function updateLinkWithLatestRelease() {
      $.getJSON("https://api.github.com/repos/pablopunk/chronocube/releases/latest").done(function (release) {
        var os = getOS()
        var link = getDownloadLink(release.tag_name, os)
        $('#downloadLink').attr("href", link)
        if (os !== 'Other') $('#downloadLink').attr("title", 'Download for '+os);
      });
    }
    
    function changeScreenshotToBlack() {
      $('#screenshot').fadeOut( 200, function() {
        $(this).attr('src', 'img/screenshot-black.png').fadeIn(200)
      })
    }
    
    function changeScreenshotToWhite() {
      $('#screenshot').fadeOut( 200, function() {
        $(this).attr('src', 'img/screenshot-white.png').fadeIn(200)
      })
    }
    </script>
  </head>

  <body>
    <center>
      <div id="tit">Chronocube</div>
      <div id="subtit">Your rubik's cube solves.</div>
      <div id="content">
        <img id="screenshot" src="img/screenshot-white.png" alt="screenshot"/>
        <div id="but-bar">
          <a href="https://github.com/pablopunk/chronocube/releases" id="downloadLink" title="Download">
            <i class="but icon ion-android-download" onmouseover="document.getElementById('label').innerText=''+this.parentNode.title" onmouseout="document.getElementById('label').innerText=''"></i>
          </a>
          <a href="http://chronocube.pablopunk.com">
            <i class="but icon ion-social-html5-outline" onmouseover="document.getElementById('label').innerText='Web app'" onmouseout="document.getElementById('label').innerText=''"></i>
          </a>
          <a href="https://github.com/pablopunk/chronocube">
            <i class="but icon ion-social-github-outline" onmouseover="document.getElementById('label').innerText='Github'" onmouseout="document.getElementById('label').innerText=''"></i>
          </a>
        </div>
        <span id="label"></span>
        <br><span style='color:white'>Redesign <a style="color:white" href="https://twitter.com/chronocubeapp/status/711361359028600832"> in progress</a></span>
      </div>
    </center>
  </body>
</html>
